<!DOCTYPE html>
<html lang="zh-cn">
  <head>
    <meta charset="utf8" />
    <meta name="viewport" content="initial-scale=1.0, width=device-width" />
    <title>
      
        GAME104第五节 | 渔人的小小世界
      
    </title>
    <meta name="description" content="" />
    <meta name="keywords" content="" />
    
      <link rel="apple-touch-icon"
            sizes="180x180"
            href="/images/apple-touch-icon.png" />
    
    
      <link rel="icon"
            type="image/png"
            sizes="32x32"
            href="/images/Doraemon32x32.ico" />
    
    
      <link rel="icon"
            type="image/png"
            sizes="16x16"
            href="/images/Doraemon16x16.ico" />
    
    
      <link rel="mask-icon"
            href="/images/logo.svg"
            color="" />
    
    
    
      
  <style>
    @font-face {
        font-family:sourceHanSerif;
        src: url(/font/normal.ttf);
        font-weight: normal;
    }
  </style>

  <style>
    @font-face {
        font-family:sourceHanSerif;
        src: url(/font/bold.ttf);
        font-weight: bold;
    }
  </style>


    
    <link rel="stylesheet"
          type="text/css"
          href='/css/layout.css' />
    
    
  <link rel="stylesheet" type="text/css" href="/css/post.css"/>
  

  <meta name="generator" content="Hexo 7.1.1"></head>
  <body>
    
      <div id="search-mask" style="display:none">
  <div class="search-main" id="search-main">
    <div class="search__head">
      <div class="search-form">
        <svg t="1706347533072"
             class="icon"
             viewBox="0 0 1024 1024"
             version="1.1"
             xmlns="http://www.w3.org/2000/svg"
             p-id="7828"
             width="20"
             height="20">
          <path d="M685.6 660.336l155.152 155.168a16 16 0 0 1 0 22.624l-11.312 11.328a16 16 0 0 1-22.624 0l-158.528-158.544a289.792 289.792 0 0 1-165.152 51.36C322.336 742.256 192 611.904 192 451.12 192 290.336 322.336 160 483.136 160c160.784 0 291.12 130.336 291.12 291.136 0 82.112-33.984 156.272-88.672 209.2z m-202.464 33.92c134.272 0 243.12-108.848 243.12-243.12C726.256 316.848 617.408 208 483.136 208 348.848 208 240 316.848 240 451.136c0 134.272 108.848 243.12 243.136 243.12z" fill="#000000" p-id="7829">
          </path>
        </svg>
        <input id="search-input" placeholder="搜索文章">
        <svg t="1706361500528"
             id="search-clear"
             class="icon"
             viewBox="0 0 1024 1024"
             version="1.1"
             xmlns="http://www.w3.org/2000/svg"
             p-id="4351"
             width="20"
             height="20">
          <path d="M512 562.688l-264.2944 264.2944-50.688-50.688L461.312 512 197.0176 247.7056l50.688-50.688L512 461.312l264.2944-264.2944 50.688 50.688L562.688 512l264.2944 264.2944-50.688 50.688L512 562.688z" fill="#00" p-id="4352">
          </path>
        </svg>
      </div>
    </div>
    <div class="search__body" id="search-result"></div>
    <div class="search__foot"></div>
  </div>
</div>

    
    <div class="head">
      <div class="nav">
        <a href='/' class="nav-logo">
          <img alt="logo" height="60px" width="60px" src="/images/Doraemon128x128.ico" />
        </a>
        <input id="navBtn" type="checkbox" />
        <div class="nav-right">
          
            <div class="search-outer">
  <div class="search" id="search-btn">
    <svg t="1706347533072"
         class="icon"
         viewBox="0 0 1024 1024"
         version="1.1"
         xmlns="http://www.w3.org/2000/svg"
         p-id="7828"
         width="20"
         height="20">
      <path d="M685.6 660.336l155.152 155.168a16 16 0 0 1 0 22.624l-11.312 11.328a16 16 0 0 1-22.624 0l-158.528-158.544a289.792 289.792 0 0 1-165.152 51.36C322.336 742.256 192 611.904 192 451.12 192 290.336 322.336 160 483.136 160c160.784 0 291.12 130.336 291.12 291.136 0 82.112-33.984 156.272-88.672 209.2z m-202.464 33.92c134.272 0 243.12-108.848 243.12-243.12C726.256 316.848 617.408 208 483.136 208 348.848 208 240 316.848 240 451.136c0 134.272 108.848 243.12 243.136 243.12z" fill="#000000" p-id="7829">
      </path>
    </svg>
    <span>搜索</span>
    <span class="search-shortcut-key">Ctrl K</span>
  </div>
</div>

          
          <div class="nav-menu">
            
              
                <a class="nav-menu-item" href="/computerStudy">技术学习</a>
              
                <a class="nav-menu-item" href="/civilStudy">公考学习</a>
              
                <a class="nav-menu-item" href="/life">休闲生活</a>
              
            
            
          </div>
        </div>
        <label class="nav-btn" for="navBtn"></label>
      </div>
    </div>
    <div class="body">
      
  <article class="post-content">
    <div class="post-inner--toc">
      <div class="post-content__head">
        <div class="post-title">GAME104第五节</div>
        <div class="post-info">
          
  <a href="/tags/%E6%B8%B8%E6%88%8F%E5%BC%95%E6%93%8E%E5%AF%BC%E8%AE%BA-GAME104/" class="post-tag">#游戏引擎导论 GAME104</a>


          <span class="post-date">2024-10-31</span>
        </div>
      </div>
      
        <aside class="toc-outer">
          <div class="toc-title">目录</div>
          <ol class="post-toc"><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#%E6%B8%B2%E6%9F%93%E4%B8%8E%E6%8C%91%E6%88%98"><span class="post-toc-text">渲染与挑战</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#%E6%B8%B2%E6%9F%93%E6%96%B9%E7%A8%8B"><span class="post-toc-text">渲染方程</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#%E6%8C%91%E6%88%98"><span class="post-toc-text">挑战</span></a></li></ol></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#%E5%9F%BA%E7%A1%80%E5%85%89%E7%85%A7%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88"><span class="post-toc-text">基础光照解决方案</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#Blinn-Phong-%E6%9D%90%E8%B4%A8%E6%A8%A1%E5%9E%8B"><span class="post-toc-text">Blinn-Phong 材质模型</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#Shadow-Map"><span class="post-toc-text">Shadow Map</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#%E6%96%B9%E6%A1%88%E6%80%BB%E7%BB%93"><span class="post-toc-text">方案总结</span></a></li></ol></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#%E4%B8%8A%E4%B8%AA%E6%97%B6%E4%BB%A3%E7%9A%84%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88"><span class="post-toc-text">上个时代的解决方案</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#%E9%A2%84%E8%AE%A1%E7%AE%97%E7%9A%84%E5%85%A8%E5%B1%80%E7%85%A7%E6%98%8E"><span class="post-toc-text">预计算的全局照明</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Indirect-Light%E8%A1%A8%E7%A4%BA%E6%96%B9%E6%A1%88"><span class="post-toc-text">Indirect Light表示方案</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#%E5%8D%B7%E7%A7%AF%E5%AE%9A%E7%90%86"><span class="post-toc-text">卷积定理</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#Spherical-Harmonics"><span class="post-toc-text">Spherical Harmonics</span></a></li></ol></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Light-Map"><span class="post-toc-text">Light Map</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#%E6%AD%A5%E9%AA%A4%E4%B8%80%EF%BC%9A%E5%88%B6%E4%BD%9Catlas"><span class="post-toc-text">步骤一：制作atlas</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#%E6%AD%A5%E9%AA%A4%E4%BA%8C%EF%BC%9Alighting"><span class="post-toc-text">步骤二：lighting</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#%E6%A0%B8%E5%BF%83%E6%80%9D%E6%83%B3"><span class="post-toc-text">核心思想</span></a></li></ol></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Light-Probe-Reflection-Probe"><span class="post-toc-text">Light Probe+Reflection Probe</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#%E4%BC%98%E7%BC%BA%E7%82%B9"><span class="post-toc-text">优缺点</span></a></li></ol></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#%E7%89%A9%E7%90%86%E6%9D%90%E8%B4%A8%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88"><span class="post-toc-text">物理材质解决方案</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#%E5%BE%AE%E5%B9%B3%E9%9D%A2%E7%90%86%E8%AE%BA"><span class="post-toc-text">微平面理论</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#BRDF"><span class="post-toc-text">BRDF</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#GGX%E6%A8%A1%E5%9E%8B"><span class="post-toc-text">GGX模型</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#Disney%E7%9A%84BRDF%E4%BF%A1%E6%9D%A1%EF%BC%88%E8%A7%84%E5%88%99%EF%BC%89"><span class="post-toc-text">Disney的BRDF信条（规则）</span></a></li></ol></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#PBR"><span class="post-toc-text">PBR</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#SG%E6%A8%A1%E5%9E%8B"><span class="post-toc-text">SG模型</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#MR%E6%A8%A1%E5%9E%8B"><span class="post-toc-text">MR模型</span></a></li></ol></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#IBL-%E5%85%89%E7%85%A7"><span class="post-toc-text">IBL 光照</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#Diffuse%E9%83%A8%E5%88%86"><span class="post-toc-text">Diffuse部分</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#Specular%E9%83%A8%E5%88%86"><span class="post-toc-text">Specular部分</span></a></li></ol></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#BRDF%E3%80%81PBR%E5%92%8CIBL"><span class="post-toc-text">BRDF、PBR和IBL</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#Shadow%E7%9A%84%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88"><span class="post-toc-text">Shadow的解决方案</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Cascade-Shadow"><span class="post-toc-text">Cascade Shadow</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#%E8%BD%AF%E9%98%B4%E5%BD%B1%E7%AE%97%E6%B3%95"><span class="post-toc-text">软阴影算法</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#%E6%80%BB%E7%BB%93"><span class="post-toc-text">总结</span></a></li></ol></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#%E6%96%B0%E6%97%B6%E4%BB%A3%E4%B8%8B%E7%9A%84%E6%B8%B2%E6%9F%93"><span class="post-toc-text">新时代下的渲染</span></a></li></ol>
          <a href="#" class="toc-top">回到顶部</a>
        </aside>
      
      <div class="post-content__body">
        
          <div class="post-gallery">
            
          </div>
        
        <h1 id="渲染与挑战"><a href="#渲染与挑战" class="headerlink" title="渲染与挑战"></a>渲染与挑战</h1><h2 id="渲染方程"><a href="#渲染方程" class="headerlink" title="渲染方程"></a>渲染方程</h2><p>渲染最初的理论：James Kajiya提出的SIGGRAPH 1986，理论方程。</p>
<p><img src="https://cdn.jsdelivr.net/gh/Disjoint3/ImgHost@main/Img/2024/10/31/20241031091250.png" alt="image-20241031091243675"></p>
<p>如何一个x点，w0观察角。x点自我发光，射出的光会被看到。这个点如果被周边其他的光源照上去时，他再反射会是什么结果。</p>
<h2 id="挑战"><a href="#挑战" class="headerlink" title="挑战"></a>挑战</h2><p>辐射度，辐射出去的能量、光照在物体上，物体反射出去的能量叫做Radiance ，入射的能量叫做Irradiance。</p>
<p><strong>挑战1：</strong>Visibility to Lights 光的可见性（阴影）和Light Source Complexity 光源复杂度</p>
<p><strong>挑战2：</strong>如何在硬件上积分（如何做shadering）</p>
<p><img src="https://cdn.jsdelivr.net/gh/Disjoint3/ImgHost@main/Img/2024/10/31/20241031092211.png" alt="image-20241031092211860"></p>
<ul>
<li>在球面函数上把光和材质之间的积分（卷积）</li>
</ul>
<p><strong>挑战3：</strong>所有的物体都是光源</p>
<p>康奈尔box</p>
<h1 id="基础光照解决方案"><a href="#基础光照解决方案" class="headerlink" title="基础光照解决方案"></a>基础光照解决方案</h1><p>模拟一个均匀的光场，进而继续研究：</p>
<p><img src="https://cdn.jsdelivr.net/gh/Disjoint3/ImgHost@main/Img/2024/10/31/20241031114031.png" alt="image-20241031114031385"></p>
<ul>
<li>simple Light： 简单的主导光</li>
<li>ambient light ：把场景中所有的光（环境光）用一个光来表示。</li>
<li>Environment Map Reflection： 环境贴图</li>
</ul>
<h2 id="Blinn-Phong-材质模型"><a href="#Blinn-Phong-材质模型" class="headerlink" title="Blinn-Phong 材质模型"></a>Blinn-Phong 材质模型</h2><p><img src="https://cdn.jsdelivr.net/gh/Disjoint3/ImgHost@main/Img/2024/10/31/20241031093140.png" alt="image-20241031093140325"></p>
<p>光可叠加，经验派们认为光照方面的组成：</p>
<ul>
<li><u>环境光（ambient）+物体的漫反射（diffuse）+物体的镜面反射（specular）</u></li>
<li>以此为基础，就是Blinn-Phong模型思想。</li>
</ul>
<p><strong>存在问题：</strong></p>
<ul>
<li><p>问题1：能量不保守（出去的能量有可能大于射入的能量）</p>
<p><img src="https://cdn.jsdelivr.net/gh/Disjoint3/ImgHost@main/Img/2024/10/31/20241031093503.png"></p>
</li>
<li><p>问题2：只能做简单的物体，复杂的物体看上去会像塑料。</p>
<p><img src="https://cdn.jsdelivr.net/gh/Disjoint3/ImgHost@main/Img/2024/10/31/20241031093503.png" alt="image-20241031093503448"></p>
</li>
</ul>
<h2 id="Shadow-Map"><a href="#Shadow-Map" class="headerlink" title="Shadow Map"></a>Shadow Map</h2><p>预处理出一个shadow map表示阴影部分。</p>
<p><img src="https://cdn.jsdelivr.net/gh/Disjoint3/ImgHost@main/Img/2024/10/31/20241031093709.png" alt="image-20241031093709385"></p>
<ul>
<li>找到光源对物体的zbuffer,对比视角的zbuffer。不一致就是阴影</li>
</ul>
<p><strong>存在问题：</strong></p>
<p>采样率不一样。采样精度不够。</p>
<p><img src="https://cdn.jsdelivr.net/gh/Disjoint3/ImgHost@main/Img/2024/10/31/20241031093828.png" alt="image-20241031093828444"></p>
<p>光源越贴近地板，阴影拉的越长，越难做。</p>
<h2 id="方案总结"><a href="#方案总结" class="headerlink" title="方案总结"></a>方案总结</h2><ul>
<li><p>simple light + Ambient表示基本材质。</p>
</li>
<li><p>environment map去hack一下快速的反射，然后把光的部分hack掉。</p>
</li>
<li><p>用Blinn-Phong把卷积的问题给简化了。</p>
</li>
<li><p>加上一个shadow map简单在光源空间采样，hack出来这部分光是否可见。</p>
</li>
</ul>
<h1 id="上个时代的解决方案"><a href="#上个时代的解决方案" class="headerlink" title="上个时代的解决方案"></a>上个时代的解决方案</h1><h2 id="预计算的全局照明"><a href="#预计算的全局照明" class="headerlink" title="预计算的全局照明"></a>预计算的全局照明</h2><p>3A游戏的第一次入侵，这里是上一个时代（5-10年前的3A的游戏）的技术。</p>
<p>主要采取空间换时间的思路。</p>
<p>全局光照&#x3D;直接+间接+间间接+间间间接+…</p>
<p><img src="https://cdn.jsdelivr.net/gh/Disjoint3/ImgHost@main/Img/2024/10/31/20241031094814.png" alt="image-20241031094813969"></p>
<h3 id="Indirect-Light表示方案"><a href="#Indirect-Light表示方案" class="headerlink" title="Indirect Light表示方案"></a>Indirect Light表示方案</h3><p>Indirect Light 间接光</p>
<p>使用多项式计算与材质BRDF卷积可以计算间接光照，这其中有以下两个可优化的方向：</p>
<ul>
<li>良好的压缩率： radiance probes 探针存储间接光照信息，信息压缩率越高越能减少内存占用。</li>
<li>易于与材质函数集成： 间接光照需要与材质函数集成计算，尽量减少计算消耗。</li>
</ul>
<h4 id="卷积定理"><a href="#卷积定理" class="headerlink" title="卷积定理"></a>卷积定理</h4><p>空间域—-&gt;频域（GAME101 callback）</p>
<p><img src="https://cdn.jsdelivr.net/gh/Disjoint3/ImgHost@main/Img/2024/10/31/20241031095243.png" alt="image-20241031095243182"></p>
<p>卷积定理的应用能够提高压缩率，减少内存占用。</p>
<h4 id="Spherical-Harmonics"><a href="#Spherical-Harmonics" class="headerlink" title="Spherical Harmonics"></a>Spherical Harmonics</h4><p>Spherical Harmonics SH 球面调和函数</p>
<p>0阶：加权平均</p>
<p>1阶：在不同方向</p>
<p>2阶：…</p>
<p>球谐函数展开，只取前几阶作近似，这样能减少计算的难度。</p>
<p>eg：只取到1阶的参数</p>
<p><img src="https://cdn.jsdelivr.net/gh/Disjoint3/ImgHost@main/Img/2024/10/31/20241031095805.png" alt="image-20241031095805760"></p>
<p>对于不同阶的压缩方式不一样，效率了很多。</p>
<ul>
<li>低阶时参数少了探针信息就少了，存储空间减少</li>
<li>计算难度降低</li>
</ul>
<h3 id="Light-Map"><a href="#Light-Map" class="headerlink" title="Light Map"></a>Light Map</h3><p>Light Map 光照贴图</p>
<p>最早的light map不是做全局光照的，后来才被用来计算全局光照。</p>
<h4 id="步骤一：制作atlas"><a href="#步骤一：制作atlas" class="headerlink" title="步骤一：制作atlas"></a>步骤一：制作atlas</h4><p>atlas（航海图，地图）：很多的几何拍到一张图上去。</p>
<p><img src="https://cdn.jsdelivr.net/gh/Disjoint3/ImgHost@main/Img/2024/10/31/20241031101128.png" alt="image-20241031101128675"></p>
<ul>
<li>三维空间复杂的几何投影到二维的空间。</li>
<li>把三维的空间变成几何，再几何简化，再分配。</li>
<li>尽可能把每个几何在texture的精度平均分配。</li>
</ul>
<p><img src="https://cdn.jsdelivr.net/gh/Disjoint3/ImgHost@main/Img/2024/10/31/20241031100950.png"></p>
<h4 id="步骤二：lighting"><a href="#步骤二：lighting" class="headerlink" title="步骤二：lighting"></a>步骤二：lighting</h4><p>light farm：很多台电脑做成的集群</p>
<p>光源设置好、参数设置好，直接开始烘培。</p>
<p><img src="https://cdn.jsdelivr.net/gh/Disjoint3/ImgHost@main/Img/2024/10/31/20241031101445.png" alt="image-20241031101445002"></p>
<p><strong>优缺点</strong></p>
<ul>
<li>好处：效率高、可以产生很多很细节的效果（因为是离线baking）</li>
<li>缺点：非常长的预计算时间、只能处理静态的光和物体、占存储空间（100m左右）</li>
</ul>
<p>light map基本现在被淘汰了</p>
<h4 id="核心思想"><a href="#核心思想" class="headerlink" title="核心思想"></a>核心思想</h4><p>空间换时间。</p>
<p>游戏场景参数化到二维的texture（那也可以考虑变成三维的xxx？）</p>
<h3 id="Light-Probe-Reflection-Probe"><a href="#Light-Probe-Reflection-Probe" class="headerlink" title="Light Probe+Reflection Probe"></a>Light Probe+Reflection Probe</h3><p>light probe 光探针：</p>
<ul>
<li>捕捉周围环境的光照</li>
<li>可为动态物体提供间接光照效果</li>
</ul>
<p>Reflection Probe 反射探针：</p>
<ul>
<li>用于捕获周围环境并生成一个立方体贴图</li>
<li>可以用来模拟物体的反射效果。</li>
</ul>
<h4 id="优缺点"><a href="#优缺点" class="headerlink" title="优缺点"></a>优缺点</h4><p>好处：runtime快，处理静态动态物体，可以runtime更新</p>
<p>缺点：比不上light map的细节效果（采样相对少）</p>
<h2 id="物理材质解决方案"><a href="#物理材质解决方案" class="headerlink" title="物理材质解决方案"></a>物理材质解决方案</h2><h3 id="微平面理论"><a href="#微平面理论" class="headerlink" title="微平面理论"></a>微平面理论</h3><p>Microfacet Theory 微平面理论</p>
<p>表面有许多的反射，看起来粗糙还是光滑和其表面法向的聚集度有关。</p>
<p>法向比较聚集就光滑。</p>
<h3 id="BRDF"><a href="#BRDF" class="headerlink" title="BRDF"></a>BRDF</h3><p>BRDF 双向反射分布函数</p>
<ul>
<li>描述物体表面将光能从任何一个入射方向反射到任何一个视点方向的反射特性的函数</li>
<li>定义为出射方向Radiance与入射方向Irradiance的比值</li>
</ul>
<h4 id="GGX模型"><a href="#GGX模型" class="headerlink" title="GGX模型"></a>GGX模型</h4><p>特定的BRDF模型，基于微平面理论。</p>
<p>光打到物体表面，要么被反射，要么被吸收。</p>
<h5 id="被反射的光"><a href="#被反射的光" class="headerlink" title="被反射的光"></a>被反射的光</h5><p>反射多少取决于法向分布，分布散乱，高光就很发散。</p>
<h5 id="被反射的光：cookTorrance模型"><a href="#被反射的光：cookTorrance模型" class="headerlink" title="被反射的光：cookTorrance模型"></a>被反射的光：cookTorrance模型</h5><p>roughness的参数α+Fresnel的参数，就能符合物理基础假设的去推理材质。</p>
<p><strong>DFG</strong></p>
<p>Normal <strong>D</strong>istribution Function（法向分布方程）。会习惯用GGX这个光照模型。</p>
<p><img src="https://cdn.jsdelivr.net/gh/Disjoint3/ImgHost@main/Img/2024/10/31/20241031104518.png" alt="image-20241031104518158"></p>
<p>引入方向分布的随机度 roughness。</p>
<p><img src="https://cdn.jsdelivr.net/gh/Disjoint3/ImgHost@main/Img/2024/10/31/20241031103810.png" alt="image-20241031103810769"></p>
<ul>
<li>GGX和其他光照模型对比。</li>
<li>（音响比方：高音要脆，低音要沉）</li>
</ul>
<p><strong>G</strong>eometric attenuation term（微表面几何内部的遮挡）</p>
<p><img src="https://cdn.jsdelivr.net/gh/Disjoint3/ImgHost@main/Img/2024/10/31/20241031104053.png" alt="image-20241031104053762"></p>
<p><strong>F</strong>resnel Equation （菲涅尔现象）</p>
<p>五次方程</p>
<h5 id="被吸收的光"><a href="#被吸收的光" class="headerlink" title="被吸收的光"></a>被吸收的光</h5><p>金属的电子捕获光子（specular 镜面反射）</p>
<p>非金属无法捕获就继续随机的反射出去（diffuse 漫反射）</p>
<h4 id="Disney的BRDF信条（规则）"><a href="#Disney的BRDF信条（规则）" class="headerlink" title="Disney的BRDF信条（规则）"></a>Disney的BRDF信条（规则）</h4><ul>
<li>每一个参数都要符合艺术家的直觉。</li>
<li>要用尽可能少的参数。</li>
<li>所有参数值的范围最好是0-1。</li>
<li>参数怎么调，他们的组合都是要有意义的。</li>
</ul>
<h3 id="PBR"><a href="#PBR" class="headerlink" title="PBR"></a>PBR</h3><p>一种基于物理的渲染技术</p>
<p>使用基于物理的BRDF模型来模拟光线与物体表面的相互作用。</p>
<h4 id="SG模型"><a href="#SG模型" class="headerlink" title="SG模型"></a>SG模型</h4><p><img src="https://cdn.jsdelivr.net/gh/Disjoint3/ImgHost@main/Img/2024/10/31/20241031105202.png" alt="image-20241031105202180"></p>
<p>用图来调节，能够非常精准的进行调节。</p>
<h4 id="MR模型"><a href="#MR模型" class="headerlink" title="MR模型"></a>MR模型</h4><p><img src="https://cdn.jsdelivr.net/gh/Disjoint3/ImgHost@main/Img/2024/10/31/20241031105814.png" alt="image-20241031105814312"></p>
<p>在SG模型外包了一层，把SG能够精准调节的参数做限制，将灵活度下降，把可控性提高。</p>
<p>缺点：非金属和金属过度时，可能会有一个小小的白边（目前无特别好的解决方案）</p>
<h3 id="IBL-光照"><a href="#IBL-光照" class="headerlink" title="IBL 光照"></a>IBL 光照</h3><p>Image-Based Light IBL 光照</p>
<p>一种先进的光照技术。用一个cube展开，表达一个四周的情况。</p>
<p>对真实的光照提前进行一些预处理，这样就可以对整个环境的光照和卷积进行处理。</p>
<p><img src="https://cdn.jsdelivr.net/gh/Disjoint3/ImgHost@main/Img/2024/10/31/20241031111220.png" alt="image-20241031111220423"></p>
<p>总结</p>
<p>BRDF材质模型：Diffuse 部分+specular部分</p>
<h4 id="Diffuse部分"><a href="#Diffuse部分" class="headerlink" title="Diffuse部分"></a>Diffuse部分</h4><p>Diffuse Irradiance Map：知道环境光的Diffuse部分，得到整个光场卷积的结果，存起来（空间换时间）</p>
<h4 id="Specular部分"><a href="#Specular部分" class="headerlink" title="Specular部分"></a>Specular部分</h4><p>specular解决方案就是在取近似，做了大量的假设。</p>
<p>优良：在环境光照中看得到一些高光部分</p>
<p>roughness部分：不同roughness（粗糙度不同，结果也不同）的结果存到硬件中的mmap中（q map的功能）。相当于可以在三维空间去查结果。每一层当单独算。</p>
<h3 id="BRDF、PBR和IBL"><a href="#BRDF、PBR和IBL" class="headerlink" title="BRDF、PBR和IBL"></a>BRDF、PBR和IBL</h3><p>PBR是一种渲染框架，依赖于BRDF模型来计算物体表面的光照效果</p>
<p>IBL提供了环境光照数据，这些数据被PBR和BRDF模型用来模拟更加真实和复杂的光照效果。</p>
<h2 id="Shadow的解决方案"><a href="#Shadow的解决方案" class="headerlink" title="Shadow的解决方案"></a>Shadow的解决方案</h2><h3 id="Cascade-Shadow"><a href="#Cascade-Shadow" class="headerlink" title="Cascade Shadow"></a>Cascade Shadow</h3><p>最经典的解决方法。</p>
<p><img src="https://cdn.jsdelivr.net/gh/Disjoint3/ImgHost@main/Img/2024/10/31/20241031111602.png" alt="image-20241031111602524"></p>
<ul>
<li>世界越开阔，从光视角采集的shadow map精度不够。不同物体的shadow所需的精度不一样。</li>
<li>这时把shadow分成几层，根据视锥的举例，采集不同距离下的shadow map。</li>
</ul>
<p>不同层级之间要做插值处理。</p>
<p>问题：存储空间大、成本大（远处shadow相当于要绘制整个空间）</p>
<h3 id="软阴影算法"><a href="#软阴影算法" class="headerlink" title="软阴影算法"></a>软阴影算法</h3><p>做软阴影的算法：PCF、PCSS、Variance Soft Shadow Map</p>
<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>光：Light map+light probe</p>
<p>材质：PBR模型（SG、MR模型）+IBL（对环境光、背光面的表达）</p>
<p>阴影：Cascade shadow + VSSM等</p>
<h1 id="新时代下的渲染"><a href="#新时代下的渲染" class="headerlink" title="新时代下的渲染"></a>新时代下的渲染</h1><p>Light map、light probe等这些在突破的边缘。</p>
<p>Real-Time Ray-Tracing 实时光追：现代游戏比较多都用来做反射。将会改变实时全局光照。</p>

      </div>
    </div>
    
      <script src='https://unpkg.com/mermaid@latest/dist/mermaid.min.js'></script>
      <script>
        if (window.mermaid) {
          mermaid.initialize({"startOnload":true});
        }
      </script>
    
  </article>
  <div class="post__foot">
    
      <div class="like-author">
  <input type="checkbox" id="likeCode" />
  <div class="author-face">
    <img height="100px"
         width="100px"
         id="front-face"
         alt="author face"
         src="/assets/Head.jpg" />
    <img height="100px"
         width="100px"
         id="back-face"
         alt="like code"
         src="/assets/Pay.jpg" />
  </div>
  <div class="like-text">“喜欢的话，请给作者倒杯卡布奇诺”</div>
  <label for="likeCode" class="like-btn">
    <svg viewBox="0 0 1024 1024"
         width="20px"
         style="margin-right: 10px"
         height="20px">
      <path d="M466.88 908.96L113.824 563.296a270.08 270.08 0 0 1 0-387.392c108.8-106.56 284.896-106.56 393.696 0 1.504 1.472 2.976 2.944 4.448 4.48 1.472-1.536 2.944-3.008 4.448-4.48 108.8-106.56 284.896-106.56 393.696 0a269.952 269.952 0 0 1 34.016 347.072l-387.392 385.6a64 64 0 0 1-89.92 0.384z" p-id="13650" fill="#ee4242" />
    </svg>
    喜欢作者
  </label>
</div>

    
    <div class="post-nav">
  
    <a class="post-nav-item-left" href="/2024/11/01/GAME104%E7%AC%AC%E5%85%AD%E8%8A%82/">
      <div class="text-align">
        <svg t="1670570876164"
             class="icon"
             viewBox="0 0 1024 1024"
             width="16"
             height="16">
          <path d="M384 512L731.733333 202.666667c17.066667-14.933333 19.2-42.666667 4.266667-59.733334-14.933333-17.066667-42.666667-19.2-59.733333-4.266666l-384 341.333333c-10.666667 8.533333-14.933333 19.2-14.933334 32s4.266667 23.466667 14.933334 32l384 341.333333c8.533333 6.4 19.2 10.666667 27.733333 10.666667 12.8 0 23.466667-4.266667 32-14.933333 14.933333-17.066667 14.933333-44.8-4.266667-59.733334L384 512z" p-id="14596" />
        </svg>
        <span class="text-small">上一篇</span>
      </div>
      <div>GAME104第六节</div>
    </a>
  
  <div class="vhr"></div>
  
    <a class="post-nav-item-right" href="/2024/10/28/GAME104%E7%AC%AC%E5%9B%9B%E8%8A%82/">
      <div class="text-align">
        <span class="text-small">下一篇</span>
        <svg t="1670570876164"
             class="icon"
             viewBox="0 0 1024 1024"
             transform="scale(-1,-1)"
             width="16"
             height="16">
          <path d="M384 512L731.733333 202.666667c17.066667-14.933333 19.2-42.666667 4.266667-59.733334-14.933333-17.066667-42.666667-19.2-59.733333-4.266666l-384 341.333333c-10.666667 8.533333-14.933333 19.2-14.933334 32s4.266667 23.466667 14.933334 32l384 341.333333c8.533333 6.4 19.2 10.666667 27.733333 10.666667 12.8 0 23.466667-4.266667 32-14.933333 14.933333-17.066667 14.933333-44.8-4.266667-59.733334L384 512z" p-id="14596" />
        </svg>
      </div>
      GAME104第四节
    </a>
  
</div>

    
      <div class="related-post">
  <div class="related__head">
  <a href="/tags/%E6%B8%B8%E6%88%8F%E5%BC%95%E6%93%8E%E5%AF%BC%E8%AE%BA-GAME104/" class="post-tag">#游戏引擎导论 GAME104</a>

</div>
  <div class="realated__body">
    
      <div class="null"><div class="null-item"><div class="null-title"><a href="\2024\10\28\GAME104第一节\" title="GAME104第一节" rel="bookmark">GAME104第一节</a></div></div><div class="null-item"><div class="null-title"><a href="\2024\10\28\GAME104第二节\" title="GAME104第二节" rel="bookmark">GAME104第二节</a></div></div><div class="null-item"><div class="null-title"><a href="\2024\10\28\GAME104第三节\" title="GAME104第三节" rel="bookmark">GAME104第三节</a></div></div><div class="null-item"><div class="null-title"><a href="\2024\04\13\hexo博客搭建\" title="hexo博客搭建" rel="bookmark">hexo博客搭建</a></div></div><div class="null-item"><div class="null-title"><a href="\2024\04\13\Shader学习（一）：基本概念\" title="Shader学习（一）：基本概念" rel="bookmark">Shader学习（一）：基本概念</a></div></div></div>
    
  </div>
</div>

    
    
  </div>

    </div>
    <div class="foot">
      <div class="foot-inner">
        <div class="foot__head">
          
            <div class="foot-line">
              <div class="matts">不</div><div class="matts">气</div><div class="matts">馁</div>
            </div>
          
            <div class="foot-line">
              <div class="matts">有</div><div class="matts">召</div><div class="matts">唤</div>
            </div>
          
            <div class="foot-line">
              <div class="matts">爱</div><div class="matts">自</div><div class="matts">由</div>
            </div>
          
        </div>
        <div class="foot__body">
          
            <div class="foot-item">
              <div class="foot-item__head">朋友</div>
              <div class="foot-item__body">
                
                  <div class="text">
                    <img alt="link" height="20px" width="20px" src="/images/icon/icon-link.svg" />
                    <a class="foot-link" target="_blank" rel="noopener" href="https://github.com/hooozen/hexo-theme-tranquility">Theme Tranquility</a>
                  </div>
                
                <div class="text">
                  <img alt="link" height="20px" width="20px" src="/images/icon/icon-link+.svg" />
                  <a class="foot-link"
                     href="mailto:1463890764@qq.com?subject=%E7%94%B3%E8%AF%B7%20Hozen.site%20%E7%9A%84%E5%8F%8B%E9%93%BE%E4%BD%8D%E7%BD%AE">
                  申请友链</a>
                </div>
              </div>
            </div>
          
          
            <div class="foot-item">
              <div class="foot-item__head">账号</div>
              <div class="foot-item__body">
                
                  <div class="text">
                    <img alt="link" height="20px" width="20px" src="/images/logo-github.svg" />
                    <a class="foot-link" target="_blank" rel="noopener" href="https://github.com/Disjoint3">Disjoint3</a>
                  </div>
                
                  <div class="text">
                    <img alt="link" height="20px" width="20px" src="/images/logo-zh.svg" />
                    <a class="foot-link" target="_blank" rel="noopener" href="https://www.zhihu.com/people/despair-49-89">despair</a>
                  </div>
                
              </div>
            </div>
          
          <div class="foot-item">
            <div class="foot-item__head">联系</div>
            <div class="foot-item__body">
              <div class="text">
                <img alt="link" height="20px" width="20px" src="/images/icon/icon-email.svg" />
                <a class="foot-link" href="mailto:1463890764@qq.com">1463890764@qq.com</a>
              </div>
            </div>
          </div>
        </div>
        <div class="copyright">
          <a href="http://example.com">渔人的小小世界</a> &nbsp;|&nbsp;由&nbsp;<a target="_blank" rel="noopener" href="https://hexo.io/">Hexo</a>&nbsp;及&nbsp;
          <svg width="20" height="20" viewBox="0 0 725 725">
            <path fill-rule="evenodd" fill="rgb(221, 221, 221)" d="M145.870,236.632 L396.955,103.578 L431.292,419.44 L156.600,522.53 L145.870,236.632 Z" />
            <path fill-rule="evenodd" fill="rgb(159, 159, 159)" d="M396.955,103.578 L564.345,234.486 L611.558,513.469 L431.292,419.44 L396.955,103.578 Z" />
            <path fill-rule="evenodd" fill="rgb(0, 0, 0)" d="M431.292,419.44 L611.558,513.469 L358.327,595.18 L156.600,522.53 L431.292,419.44 Z" />
          </svg>
          <a target="_blank" rel="noopener" href="https://github.com/hooozen/hexo-theme-tranquility">致远</a>&nbsp;驱动
        </div>
      </div>
    </div>
    
    
      <script src="/js/search.js"></script>
      <script>searchInitialize("/search.json")</script>
    
    
  

  </body>
</html>
